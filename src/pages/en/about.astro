---
import Layout from '../../layouts/Layout.astro';
import ImageGallery from '../../components/ImageGallery.astro';
import ExperienceSection from '../../components/ExperienceSection.astro';
import EducationSection from '../../components/EducationSection.astro';
import PublicationSection from '../../components/PublicationSection.astro';
import CertificationSection from '../../components/CertificationSection.astro';
import MiscSection from '../../components/MiscSection.astro';
import HobbySection from '../../components/HobbySection.astro';
import { aboutDataEn } from '../../data/about';
import { getTranslation } from '../../i18n/translations';
import { getSiteName } from '../../i18n/utils';
import { profileData } from '../../data/profile';

const profileImages = [
  '/avatar.png',
  '/profile/beer.webp', // 2枚目の画像
  '/profile/cosmos.webp', // 3枚目の画像
  '/profile/curry.webp',
  '/profile/mliko.webp',
  '/profile/misokin.webp',
  '/profile/idabashi.webp',
  '/profile/maple.webp',
  '/profile/lake.webp',
  '/profile/sunset.webp',
  '/profile/station.webp',
  '/profile/kamiike.webp',
  '/profile/tunnel.webp',
];

const pageTitle = getTranslation(Astro.currentLocale, 'page.about');
const siteName = getSiteName(Astro.currentLocale);
const name = `${profileData.nameEn} / ${profileData.name}`;
const username = `@${profileData.username} / ${profileData.usernameJa}`;
---

<Layout
  title={`${pageTitle} - ${siteName}`}
  description={`Background and qualifications of ${profileData.nameEn} (@${profileData.username})`}
>
  <article class="about-page">
    <section class="about-section intro-section">
      <div class="profile-header">
        <div class="profile-image-container">
          <ImageGallery images={profileImages} alt={profileData.nameEn} />
          <a href="/en/identity/key/" class="pgp-key-badge" title="View PGP Public Key">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <path
                d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"
              ></path>
            </svg>
          </a>
        </div>
        <div class="profile-info">
          <h2>{name}</h2>
          <p class="username">{username}</p>
        </div>
      </div>
    </section>

    <section class="about-section">
      <h3 class="section-title">About Me</h3>
      <div class="section-content">
        <p>
          As a software engineer, I specialize in application development and supporting
          organizations in bringing their development processes in-house. My work spans the full
          spectrum—from application coding to public cloud infrastructure. Recently, I've been
          focused on putting DevOps practices into action.
        </p>
        <p>
          I have a strong interest in the theoretical side of computing—fields like theoretical
          computer science, mathematical logic, and functional programming—which help uncover the
          "black box" mechanisms behind the tools we use. My favorite programming language is
          Standard ML (that's Meta Language, not Machine Learning!).
        </p>
        <p>
          I deeply respect programming languages and tools that are kind to people (both developers
          and users) and the communities that have nurtured them. Supported by the open-source
          ecosystem, my goal is to give back to the community as much as I have gained.
        </p>
      </div>
    </section>

    <section class="about-section">
      <h3 class="section-title">Experience</h3>
      <div class="section-content">
        <ExperienceSection items={aboutDataEn.experiences} />
      </div>
    </section>

    <section class="about-section">
      <h3 class="section-title">Education</h3>
      <div class="section-content">
        <EducationSection items={aboutDataEn.educations} />
      </div>
    </section>

    <section class="about-section">
      <h3 class="section-title">Publications</h3>
      <div class="section-content">
        <PublicationSection items={aboutDataEn.publications} />
      </div>
    </section>

    <section class="about-section">
      <h3 class="section-title">Certifications</h3>
      <div class="section-content">
        <CertificationSection categories={aboutDataEn.certifications} />
      </div>
    </section>

    {
      aboutDataEn.misc && aboutDataEn.misc.length > 0 && (
        <section class="about-section">
          <h3 class="section-title">Misc</h3>
          <div class="section-content">
            <MiscSection categories={aboutDataEn.misc} />
          </div>
        </section>
      )
    }

    {
      aboutDataEn.hobbies && aboutDataEn.hobbies.length > 0 && (
        <section class="about-section">
          <h3 class="section-title">Hobby</h3>
          <div class="section-content">
            <HobbySection items={aboutDataEn.hobbies} />
          </div>
        </section>
      )
    }
  </article>
</Layout>

<style>
  .about-page {
    padding: 2rem 0;
  }

  .about-section {
    margin-bottom: 3rem;
  }

  .intro-section {
    text-align: center;
    margin-bottom: 3rem;
    padding-bottom: 2rem;
    border-bottom: 2px solid var(--color-border);
  }

  .profile-header {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 1rem;
  }

  .profile-image-container {
    position: relative;
    width: 100%;
    max-width: 300px;
  }

  .pgp-key-badge {
    position: absolute;
    /* デフォルト位置 (タブレット・中サイズ) */
    bottom: 4rem;
    right: 1rem;
    /* デフォルトサイズ */
    width: 56px;
    height: 56px;
    background: var(--color-primary);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    text-decoration: none;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    transition: all 0.3s ease;
    z-index: 10;
  }

  .pgp-key-badge:hover {
    background: var(--color-primary-dark);
    transform: scale(1.1);
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
  }

  .pgp-key-badge svg {
    /* デフォルト: 56px ボタンに対して約50%のアイコン */
    width: 28px;
    height: 28px;
  }

  .profile-image-container :global(.main-image) {
    border-radius: 50%;
    border: 4px solid var(--color-primary);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  }

  .profile-image-container :global(.thumbnail img) {
    border-radius: 50%;
  }

  .profile-info h2 {
    font-size: 2rem;
    color: var(--color-primary-dark);
    margin-bottom: 0.5rem;
  }

  .username {
    color: var(--color-text-light);
    font-size: 1.1rem;
    margin: 0;
  }

  .section-title {
    font-size: 1.6rem;
    color: var(--color-primary-dark);
    margin-bottom: 1.5rem;
    padding-bottom: 0.5rem;
    border-bottom: 2px solid var(--color-primary);
  }

  .section-content {
    color: var(--color-text);
    line-height: 1.8;
  }

  .section-content p {
    margin-bottom: 1rem;
  }

  /* PC版でサイド画像を表示する場合は幅を広げる */
  @media (min-width: 768px) {
    .profile-image-container {
      max-width: 600px;
    }

    /* PC版: アイコンを少し大きく，位置も調整 */
    .pgp-key-badge {
      bottom: 4rem;
      right: 10rem;
      width: 64px;
      height: 64px;
    }

    .pgp-key-badge svg {
      /* PC版: 64px ボタンに対して約50%のアイコン */
      width: 32px;
      height: 32px;
    }
  }

  @media (max-width: 640px) {
    .profile-image-container {
      max-width: 220px;
    }

    /* SP版: アイコンを少し小さく，位置も調整 */
    .pgp-key-badge {
      bottom: 3.5rem;
      right: 0.5rem;
      width: 42px;
      height: 42px;
    }

    .pgp-key-badge svg {
      /* SP版: 42px ボタンに対して約50%のアイコン */
      width: 21px;
      height: 21px;
    }

    .profile-info h2 {
      font-size: 1.6rem;
    }

    .section-title {
      font-size: 1.4rem;
    }
  }
</style>
